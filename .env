# ─────────────────────────────
# Core Service
# ─────────────────────────────
PORT=3000
NODE_ENV=production
DEFAULT_ALIAS=prod
FEATURED_PRIMARY_ALIAS=prod
TITLE_ID=20CA2
OS=iOS
TRUST_PROXY=1
LOG_LEVEL=info

# ─────────────────────────────
# Auth / Security
# ────────────────────────────
JWT_SECRET=CHANGE_ME_JWT_SECRET_MIN_32_CHARS
ADMIN_USER=admin
ADMIN_PASS=CHANGE_ME_STRONG_PASSWORD

# Comma-separated list, e.g. https://example.com,https://foo.bar
CORS_ORIGINS=

# ─────────────────────────────
# HTTP / Upstream
# ─────────────────────────────
HTTP_MAX_SOCKETS=512
HTTPS_MAX_SOCKETS=512
UPSTREAM_TIMEOUT_MS=20000
RETRY_BUDGET=3

# Optional: FX rate EUR → USD for pricing, e.g. 1.07
FX_USD_PER_EUR=

# ─────────────────────────────
# Caching
# ─────────────────────────────
SESSION_TTL_MS=1800000        # 30 minutes
SESSION_CACHE_MAX=1000

DATA_CACHE_MAX=20000
DATA_TTL_MS=300000            # 5 minutes

# Endpoint-specific TTLs
DETAILS_TTL_MS=120000         # /marketplace/details
SALES_TTL_MS=120000           # /marketplace/sales
SUMMARY_TTL_MS=300000         # /marketplace/summary
CREATOR_STATS_TTL_MS=60000    # /marketplace/:creatorName/stats
ADV_SEARCH_TTL_MS=60000       # POST /marketplace/search/advanced
RECOMMENDATIONS_TTL_MS=60000  # /marketplace/recommendations/:itemId
FEATURED_SERVERS_TTL_MS=300000 # /marketplace/featured-servers

# ─────────────────────────────
# Marketplace / Multilang
# ─────────────────────────────
MULTILANG_ALL=true
MULTILANG_ENRICH_BATCH=100
MULTILANG_ENRICH_CONCURRENCY=5

STORE_CONCURRENCY=6
STORE_MAX_FOR_PRICE_ENRICH=500

# Pagination defaults
PAGE_SIZE=100
REVIEWS_ENABLED=true
REVIEWS_FETCH_COUNT=20

# Advanced search batching
ADV_SEARCH_BATCH=300
ADV_SEARCH_MAX_BATCHES=10
MAX_SEARCH_BATCHES=10
MAX_FETCH_BATCHES=20

PLAYFAB_CONCURRENCY=12
PLAYFAB_BATCH=600

# ─────────────────────────────
# Minecraft Discovery
# ─────────────────────────────
MC_AUTH_BASE=https://authorization.franchise.minecraft-services.net
MC_DISCOVERY_BASE=https://gatherings-secondary.franchise.minecraft-services.net
MC_CLIENT_VERSION_URL=https://displaycatalog.mp.microsoft.com/v7.0/products/9NBLGGH2JHXJ/?market=CA&languages=en-CA,en,neutral

MC_CLIENT_VERSION=1.21.131

MC_CLIENT_VERSION_TTL_MS=43200000
MC_TOKEN_TTL_MS=900000

MC_LANGUAGE=en
MC_LANGUAGE_CODE=en-US
MC_REGION_CODE=US
MC_TOKEN_TYPE=playfab
MC_APPLICATION_TYPE=MinecraftPE
MC_PLATFORM=Windows10
MC_STORE_PLATFORM=uwp.store

MC_FEATURED_FILTER=(contentType eq '3PP_V2.0') and platforms/any(tp: tp eq 'android.googleplay' and tp eq 'title.bedrockvanilla')
MC_FEATURED_SCID=4fc10100-5f7a-4470-899b-280835760c07
MC_FEATURED_ORDER=startDate desc
MC_FEATURED_SELECT=images
MC_FEATURED_TOP=75

# ─────────────────────────────
# Validation / Swagger
# ─────────────────────────────
VALIDATE_REQUESTS=false
VALIDATE_RESPONSES=false
ENABLE_DOCS=true
SWAGGER_SERVER_URL=http://localhost:3000

# ─────────────────────────────
# Background Watcher (Sales / Items / Prices / Trending)
# ─────────────────────────────
ENABLE_SALES_WATCHER=false
SALES_WATCH_INTERVAL_MS=30000

ENABLE_ITEM_WATCHER=false
ITEM_WATCH_INTERVAL_MS=30000
ITEM_WATCH_ITEMS_PER_REQUEST=200
ITEM_WATCH_MAX_ITEMS=10000
ITEM_WATCH_BOOTSTRAP_ITEMS_PER_REQUEST=200
ITEM_WATCH_BOOTSTRAP_MAX_ITEMS=600
ITEM_WATCH_LAST_RUN_FILE=./data/last_run.txt

ENABLE_PRICE_WATCHER=false
PRICE_WATCH_INTERVAL_MS=30000
PRICE_WATCH_MAX_STORES=50

ENABLE_TRENDING_WATCHER=false
TRENDING_INTERVAL_MS=60000
TRENDING_WINDOW_HOURS=24
TRENDING_PAGE_TOP=200
TRENDING_PAGES=3
TRENDING_TOP_N=20

ENABLE_FEATURED_CONTENT_WATCHER=true
FEATURED_CONTENT_WATCH_INTERVAL_MS=21600000

# ─────────────────────────────
# Rate Limiting
# ─────────────────────────────
# Global switch
RATE_LIMIT_ENABLED=true       # or RATE_LIMIT_ENABLE=true; both accepted

# Global defaults (fallback)
RATE_LIMIT_WINDOW_MS=60000    # 60s
RATE_LIMIT_MAX=60

# Login rate limits
RATE_LIMIT_LOGIN_WINDOW_MS=900000   # 15 minutes
RATE_LIMIT_LOGIN_MAX=20

# Login burst limits (additional)
RATE_LIMIT_LOGIN_BURST_WINDOW_MS=10000 # 10s
RATE_LIMIT_LOGIN_BURST_MAX=50

# Marketplace limits
RATE_LIMIT_MARKETPLACE_WINDOW_MS=3600000  # 1h
RATE_LIMIT_MARKETPLACE_MAX=2000

# Admin limits
RATE_LIMIT_ADMIN_WINDOW_MS=3600000
RATE_LIMIT_ADMIN_MAX=1000

# Health check limits
RATE_LIMIT_HEALTH_WINDOW_MS=300000  # 5 minutes
RATE_LIMIT_HEALTH_MAX=500

# ─────────────────────────────
# Webhooks
# ─────────────────────────────
WEBHOOK_CONCURRENCY=5
WEBHOOK_MAX_RETRIES=5
WEBHOOK_TIMEOUT_MS=6000
